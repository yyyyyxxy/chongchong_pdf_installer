# 虫虫钢琴乐谱下载器

一个用于下载虫虫钢琴网站乐谱的Python工具，支持自动下载五线谱和简谱版本的PDF文件。

## 功能特点

- 🎵 自动下载五线谱和简谱版本
- 📄 导出为高质量PDF文件
- 📁 自动按乐谱标题创建文件夹分类存储
- 🔗 支持单个链接和批量链接处理
- 💻 支持命令行参数和交互式输入

## 环境要求

- Python 3.6+
- Microsoft Edge 浏览器
- 网络连接

## 安装依赖

首先安装必需的Python包：

```bash
pip install requests beautifulsoup4 selenium
```

## 下载Edge驱动

1. 访问 [Microsoft Edge WebDriver下载页面](https://developer.microsoft.com/en-us/microsoft-edge/tools/webdriver/)
2. 下载与您的Edge浏览器版本对应的 `msedgedriver.exe`
3. 将 `msedgedriver.exe` 放在脚本同目录下

### 如何查看Edge版本
- 打开Edge浏览器
- 点击右上角三个点 → 帮助和反馈 → 关于Microsoft Edge
- 查看版本号并下载对应版本的驱动

## 使用方法

### 方法1：交互式输入

```bash
python downloader.py
```

按提示输入乐谱链接，每行一个，输入空行结束。

### 方法2：单个链接

```bash
python downloader.py -u "https://www.gangqinpu.com/html/1002952.htm"
```

### 方法3：批量处理

创建一个文本文件（如 `links.txt`），每行放一个链接：

```
https://www.gangqinpu.com/html/1002952.htm
https://www.gangqinpu.com/html/1002953.htm
https://www.gangqinpu.com/html/1002954.htm
```

然后运行：

```bash
python downloader.py -f links.txt
```

## 输出结果

程序会为每个乐谱创建一个以乐谱标题命名的文件夹，包含：
- `乐谱标题-五线谱.pdf`
- `乐谱标题-简谱.pdf`

## 常见问题及解决方法

### ❌ 找不到Edge驱动文件

**错误信息：** `错误: 找不到Edge驱动文件 msedgedriver.exe`

**解决方法：**
1. 确保下载了正确版本的msedgedriver.exe
2. 将驱动文件放在与downloader.py相同的目录
3. 检查文件名是否正确（区分大小写）

### ❌ 无法加载乐谱内容

**错误信息：** `无法加载乐谱内容，请检查链接是否正确`

**可能原因和解决方法：**
1. **网络连接问题** - 检查网络连接是否正常
2. **链接格式错误** - 确保使用正确的虫虫钢琴链接格式
3. **页面结构变化** - 网站可能更新了页面结构，需要等待程序更新
4. **反爬虫机制** - 等待几分钟后重试，或换个时间段使用

### ❌ 未找到乐谱iframe

**错误信息：** `未找到乐谱iframe，可能不是支持的乐谱页面`

**解决方法：**
1. 确认链接是指向具体乐谱页面，而非搜索页或列表页
2. 检查链接是否完整有效
3. 尝试在浏览器中打开链接确认页面正常显示

### ❌ 文件不存在

**错误信息：** `文件不存在: links.txt`

**解决方法：**
1. 确保文件路径正确
2. 检查文件名拼写
3. 使用绝对路径或确保文件在当前工作目录

### ❌ 权限问题

**可能遇到的问题：** 无法创建文件夹或保存PDF

**解决方法：**
1. 以管理员身份运行命令提示符
2. 确保有写入权限的目录
3. 检查磁盘空间是否充足

### 🐌 下载速度慢

**优化建议：**
1. 确保网络连接稳定
2. 避免在网络高峰期使用
3. 批量下载时可以分批处理

## 注意事项

1. **合法使用** - 仅供个人学习使用，请遵守网站服务条款
2. **适度使用** - 避免频繁请求，以免对服务器造成压力
3. **版本兼容** - 确保Edge浏览器和驱动版本匹配
4. **备份重要数据** - 下载的文件建议及时备份

## 技术支持

如果遇到其他问题：

1. 检查Python和依赖包是否正确安装
2. 确认Edge浏览器能正常访问目标网站
3. 查看控制台输出的详细错误信息
4. 尝试重启程序或重新下载驱动文件

## 更新日志

- v1.0 - 基础功能实现，支持五线谱和简谱下载
- 支持批量处理和命令行参数

---

**免责声明：** 本工具仅供学习交流使用，请遵守相关网站的使用条款和版权规定。
